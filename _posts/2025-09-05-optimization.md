---
layout:       post
title:        "最优化理论 —— 惩罚函数-外点法"
subtitle:     "将约束优化转化为无约束优化的经典方法"
date:         2025-09-05 10:00:00
author:       "zxh"
header-style: text
catalog:      true
mathjax:      true
tags:
  - Optimization
  - Nonlinear Programming
  - Math
---

惩罚函数法又称乘子法，是将约束优化问题转换为无约束优化问题的方法之一。其基本思想就是通过在原始的目标函数中添加一个障碍函数（也可以理解成惩罚函数）来代替约束条件中的不等式约束。如果当前解不满足约束条件，就在目标项上加上一个正向的惩罚（这里考虑的都是最小化问题），强迫当前解往可行域的方向走。至于正向惩罚的力度，取决于所用的映射函数，即惩罚函数。

## 一、非线性规划模型

$$
\begin{cases}
\min & f(\boldsymbol{x}) \\
\text{s.t. } & g_i(\boldsymbol{x}) \le 0,\quad i=1,\dots,p \\
& h_j(\boldsymbol{x}) = 0,\quad j=1,\dots,q
\end{cases}
$$

其中，$f(\boldsymbol{x})$、$g_i(\boldsymbol{x})(i=1,2,\dots,p)$ 和 $h_j(\boldsymbol{x})(j=1,2,\dots,q)$ 是$\mathbb{R}^n$ 上的连续函数。

> 注意：后面惩罚函数的选取与这个模型相关，如果不等式约束方向相反惩罚函数就有所不同，也可以理解为该模型就是标准型。

由于约束条件是非线性的，不能用消元法将其转换为无约束问题，在求解时需同时考虑目标函数值下降和满足约束条件。可以通过由目标函数和约束条件组成惩罚函数，将原问题转化为极小化惩罚函数的无约束问题。

## 二、惩罚函数外点法

惩罚函数基本思想：通过构造惩罚函数将约束问题转化为无约束问题，进而用无约束最优化方法求解。主要分为内点法和外点法。注意：惩罚函数对目标函数的凹凸性没有要求，且结合启发式算法（如遗传算法、蚁群算法、禁忌搜索等）几乎可以求解任何问题，因为启发式算法无需目标函数的梯度等信息。外点法不保证搜索点保持在可行域内（搜索范围包括可行域和不可行域），适用于包含不等式约束或等式约束的优化问题。

惩罚函数为：

$$
\phi(\boldsymbol{x}, r^{(k)})
= f(\boldsymbol{x})
+ r^{(k)} \sum_{i=1}^{p} \left\{ \max\big[0,\, g_i(\boldsymbol{x})\big] \right\}^2
$$

其中，$r^{(k)}$ 为趋于无穷大的严格递增正数列，$r^{(k)} = C\, r^{(k-1)}$ 且 $C>1$，$\lim_{k\to\infty} r^{(k)} = \infty$。迭代点在可行域内时，惩罚项为 0，惩罚函数等于原函数；迭代点在可行域外时，惩罚项大于 0，大于原函数。因此，由于罚因子严格递增，随着迭代进行，可以迫使惩罚项趋于 0，从而逼近原函数。



